# Сборка и скачивание Android APK через EAS (release)

## Что уже сделано

- В проекте создан **eas.json** с профилями:
  - **production** — release-сборка, на выходе **APK** (удобно ставить на устройство и раздавать).
  - **preview** — внутренняя раздача, тоже APK.

## Шаги (один раз — привязка проекта)

1. **Инициализация EAS** (если ещё не делали):
   ```bash
   npx eas-cli init
   ```
   В терминале выбери аккаунт (например **webnum.com** или **amir.khalim0v**). Этим проектом будет привязан к Expo.

2. **Запуск сборки Android APK (release):**
   ```bash
   npm run android:build
   ```
   или, если установлен EAS CLI глобально:
   ```bash
   npx eas build --platform android --profile production
   ```
   Сборка пойдёт в облако EAS. В конце в терминале будет ссылка на страницу билда.

## Где взять APK после сборки

1. Открой [expo.dev](https://expo.dev) → свой аккаунт → проект **Doc Trust** (или как он отобразится после `eas init`).
2. Перейди в **Builds** (или по ссылке из терминала после `eas build`).
3. Дождись статуса **Finished** у Android-билда.
4. Нажми **Download** — скачается **APK** (release-вариант).

Тот же APK можно скачать по прямой ссылке со страницы билда на expo.dev.

## Ошибка при установке APK на эмулятор/устройство

Если при установке скачанного APK появляется ошибка:
```text
INSTALL_FAILED_UPDATE_INCOMPATIBLE: Existing package com.anonymous.ailawyer signatures do not match
```
это значит, что на устройстве/эмуляторе уже стоит старая версия приложения (например, собранная локально с другим ключом подписи). Android не даёт обновить приложение, если подпись изменилась.

**Что сделать:** удалить старую версию, затем установить новый APK.

1. **Вручную:** на устройстве/эмуляторе зайди в Настройки → Приложения → Doc Trust (или AI Lawyer) → Удалить.
2. **Через ADB** (эмулятор или устройство с отладкой по USB):
   ```bash
   adb uninstall com.anonymous.ailawyer
   ```
   Затем снова установи APK (перетащи файл на эмулятор или выполни `adb install путь/к/файлу.apk`).

В проекте есть скрипт для удаления приложения с подключённого устройства/эмулятора (подключи устройство или запусти эмулятор, затем):
```bash
npm run android:uninstall
```
После этого установи скачанный APK заново — ошибка установки должна пропасть.

## Дополнительно

- Чтобы собирать только APK и не трогать настройки для магазина, используется профиль **production** с `"android.buildType": "apk"` в **eas.json**.
- Для загрузки в Google Play позже можно добавить отдельный профиль с `buildType: "app-bundle"` (AAB).
